import{i as P,u as F,d as G,_ as H,o as W,r as V,c as d,h as o,e as c,f as n,w as s,n as f,z as C,A as m,C as v,m as _,q,aD as y,j as h,be as X,F as J,t as K,l,Q as Y,aE as Z,v as ee,ah as te,aX as D,G as ae}from"./app.10579c01.js";import{Q as ne}from"./QBadge.6984755e.js";import{Q as se}from"./QChatMessage.057585fe.js";const le={class:"text-h6"},oe={key:0},ie={key:1},pe={__name:"RcStationMessage",props:{station:Object,type:Number},setup(M){const u=M;P("can");let i=F();const Q=G(()=>H(()=>import("./index.600cd088.js"),["assets/index.600cd088.js","assets/app.10579c01.js","assets/app.4fce15f2.css"]));W(async()=>{});let r=V(),p=V(!1);const T=async a=>{await D({method:"delete",url:"/api/sheetmessage/"+a,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}})},j=async()=>{const a={message:r.value};await D({method:"put",url:"/api/sheetmessage/"+u.station.id,withCredentials:!0,data:a,headers:{Accept:"application/json","Content-Type":"application/json"}}),r.value=null};let B=async()=>{i.stationChatWindowId=u.station.id},x=async()=>{r.value=null,i.stationChatWindowId=null},$=a=>new Date(a).getTime(),N=a=>{const t=new Date(a);return new Date-t<18e5},A=d(()=>k.value.length),w=d(()=>i.getUnreadMessageCount(u.station.id)),I=d(()=>A.value?"fa-solid fa-message":"fa-regular fa-message"),b=a=>i.user_id==a,U=(a,t)=>i.user_id==t?"me":a,E=a=>i.user_id==a?"amber-7":"positive",L=d(()=>!r.value),k=d(()=>i.getStationMessages(u.station.id)),O=a=>"https://image.eveonline.com/Character/"+a.user.eve_user_id+"_128.jpg";return(a,t)=>(o(),c("div",null,[n(_,{"text-color":"positive",icon:I.value,padding:"none",round:"",flat:"",onClick:t[0]||(t[0]=e=>p.value=!0)},{default:s(()=>[w.value&&!p.value?(o(),f(ne,{key:0,color:"red",floating:""},{default:s(()=>[C(m(w.value),1)]),_:1})):v("",!0)]),_:1},8,["icon"]),n(te,{modelValue:p.value,"onUpdate:modelValue":t[4]||(t[4]=e=>p.value=e),onBeforeShow:t[5]||(t[5]=e=>l(B)()),onBeforeHide:t[6]||(t[6]=e=>l(x)())},{default:s(()=>[n(q,{class:"my-card myRoundTop",style:{width:"1000px","max-height":"900px",height:"900px"}},{default:s(()=>[n(y,{class:"bg-primary myCardHeader text-center"},{default:s(()=>[h("div",le,"Notes for Station "+m(u.station.name),1)]),_:1}),n(y,{id:"messages",class:"overflow-auto",style:{height:"600px"}},{default:s(()=>[n(X,{"enter-active-class":"animate__animated animate__zoomIn"},{default:s(()=>[(o(!0),c(J,null,K(k.value,(e,R)=>(o(),f(se,{key:`${e.id}-message`,text:[e.message],name:l(U)(e.user.name,e.user_id),avatar:l(O)(e),sent:l(b)(e.user_id),"bg-color":l(E)(e.user_id)},{stamp:s(()=>[C("Sent: "),(o(),f(l(Q),{key:`${e.id}-time`,interval:6e4,time:l($)(e.created_at)},{default:s(({days:g,hours:S,minutes:z,seconds:re})=>[g!="00"?(o(),c("span",oe,m(g)+"days, ",1)):v("",!0),S!="00"?(o(),c("span",ie,m(S)+"hours,",1)):v("",!0),h("span",null,m(z)+"minutes",1),C(" ago ")]),_:2},1032,["time"])),l(N)(e.created_at)&&l(b)(e.user_id)?(o(),f(_,{key:0,color:"negative",padding:"none",icon:"fa-solid fa-trash-can",flat:"",size:"xs",rounded:"",onClick:g=>T(e.id)},null,8,["onClick"])):v("",!0)]),_:2},1032,["text","name","avatar","sent","bg-color"]))),128))]),_:1})]),_:1}),n(y,null,{default:s(()=>[h("div",null,[n(Y,{"input-style":"height: 150px",modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=e=>r.value=e),clearable:"",outlined:"",rounded:"",dense:"",type:"textarea",label:"Message"},null,8,["modelValue"])])]),_:1}),n(Z,{align:"between"},{default:s(()=>[n(_,{rounded:"",label:"Submit",color:"primary",disable:L.value,onClick:t[2]||(t[2]=e=>j())},null,8,["disable"]),ee(n(_,{rounded:"",label:"Close",color:"negative",onClick:t[3]||(t[3]=e=>l(x)())},null,512),[[ae]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{pe as default};
